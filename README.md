<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fast Phone | Ø§Ù„Ù…ØªØ¬Ø± ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª</title>
  <meta name="description" content="ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ Ù„Ù…Ø­Ù„ Fast Phone: Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø§ØªØŒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¬ÙˆØ¬Ù„ (Ù…Ø­Ø§ÙƒØ§Ø©)ØŒ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§ØªØŒ ÙˆØ§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ. ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„ÙØ±Ù†Ø³ÙŠØ© - ÙˆØ¶Ø¹ Ø¯Ø§ÙƒÙ† Ø§ÙØªØ±Ø§Ø¶ÙŠ." />
  <meta name="theme-color" content="#0ea5e9" />
  <style>
    /* ================ Base (Dark) ================ */
    *,*::before,*::after{box-sizing:border-box}html,body{height:100%}body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Noto Kufi Arabic","Cairo",Tahoma,Arial;color:#e2e8f0;background:#071023;line-height:1.5;-webkit-font-smoothing:antialiased}
    .container{width:min(1100px,94vw);margin-inline:auto;padding:1rem}
    header{position:sticky;top:0;background:linear-gradient(180deg,rgba(2,6,23,.9),rgba(2,6,23,.6));backdrop-filter:saturate(160%) blur(12px);border-bottom:1px solid rgba(148,163,184,.06);z-index:50}
    .nav{display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:1rem;padding:.85rem 0}
    .brand{display:flex;align-items:center;gap:.6rem;font-weight:800}
    .logo{width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,#06b6d4,#7dd3fc);display:grid;place-items:center;color:#001018;font-weight:900}
    .searchbar{display:flex;align-items:center;justify-content:center;gap:.6rem}
    input[type="search"]{width:min(520px,40vw);padding:.6rem .9rem;border-radius:999px;border:1px solid rgba(148,163,184,.08);background:#0f1724;color:var(--text,#e2e8f0);outline:none}
    .actions{display:flex;justify-content:flex-end;align-items:center;gap:.5rem}
    .btn{display:inline-flex;align-items:center;gap:.5rem;padding:.55rem .9rem;border-radius:999px;border:1px solid rgba(148,163,184,.06);background:#0f1724;color:var(--text,#e2e8f0);cursor:pointer}
    .btn.primary{background:linear-gradient(135deg,#06b6d4,#38bdf8);color:#001018;font-weight:700;border-color:transparent}
    .chip{font-size:.85rem;padding:.3rem .6rem;border-radius:999px;border:1px solid rgba(148,163,184,.06);color:#94a3b8}
    main{padding:1.1rem 0 4rem}
    .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:1.4rem;align-items:center;margin:1rem 0 2rem}
    .card{background:linear-gradient(180deg, rgba(2,6,23,.25), rgba(2,6,23,.45));border:1px solid rgba(148,163,184,.06);border-radius:14px;padding:1.1rem;box-shadow:0 8px 22px rgba(0,0,0,.45)}
    .stats{display:flex;gap:1rem;flex-wrap:wrap;margin-top:.8rem}
    .stat{background:#071226;border-radius:12px;padding:.7rem 1rem;min-width:130px;border:1px solid rgba(148,163,184,.04)}
    .grid.two-col{display:grid;grid-template-columns:1.2fr .8fr;gap:1rem}
    .section-title{display:flex;align-items:center;justify-content:space-between;margin:1rem 0 .6rem}
    .catalog{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:.8rem}
    .product{display:flex;flex-direction:column}
    .thumb{aspect-ratio:1/1;border-radius:12px 12px 0 0;overflow:hidden;background:#041226;display:grid;place-items:center}
    .product .body{padding:.8rem;display:flex;flex-direction:column;gap:.45rem}
    .price{color:#86efac;font-weight:800}
    .old{color:#94a3b8;text-decoration:line-through;margin-inline-start:.4rem}
    .actions .btn{padding:.45rem .7rem;border-radius:10px}
    .services{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:.8rem}
    .service{display:flex;gap:.8rem;padding:.9rem}
    .cart{position:sticky;top:78px;align-self:start}
    .cart .head{display:flex;align-items:center;justify-content:space-between;padding:.8rem 1rem;border-bottom:1px dashed rgba(148,163,184,.04)}
    .items{max-height:52vh;overflow:auto;padding:.6rem;display:flex;flex-direction:column;gap:.6rem}
    .row{display:grid;grid-template-columns:1fr auto;gap:.6rem;align-items:center;padding:.6rem .7rem;border-radius:10px;border:1px dashed rgba(148,163,184,.04);background:transparent}
    .pill{font-size:.85rem;padding:.35rem .7rem;border-radius:999px;border:1px dashed rgba(148,163,184,.04);color:#94a3b8}
    .empty{color:#94a3b8;text-align:center;padding:2rem .6rem}
    footer{margin-top:2rem;padding:1rem 0 2rem;color:#94a3b8;border-top:1px dashed rgba(148,163,184,.04);font-size:.95rem;display:grid;gap:.4rem}
    dialog{border:none;border-radius:14px;width:min(860px,96vw);background:#0f1724;color:var(--text,#e2e8f0);box-shadow:0 12px 30px rgba(0,0,0,.6)}
    dialog::backdrop{background:rgba(2,6,23,.6);backdrop-filter:blur(2px)}
    .modal-body{padding:1rem;display:grid;gap:.8rem}
    .field{display:grid;gap:.25rem}
    .field input,.field textarea,.field select{background:#071226;border:1px solid rgba(148,163,184,.04);color:var(--text,#e2e8f0);padding:.6rem .7rem;border-radius:10px}
    .icon-btn{display:inline-grid;place-items:center;width:34px;height:34px;border-radius:10px;border:1px solid rgba(148,163,184,.04);background:#071226;cursor:pointer}
    @media (max-width:920px){.hero{grid-template-columns:1fr}.grid.two-col{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container nav">
      <div class="brand">
        <div class="logo">âš¡ï¸</div>
        <div>
          <div style="font-size:1.05rem" data-i18n="brandTitle">Fast Phone</div>
          <small data-i18n="brandSubtitle" style="color:#94a3b8">Ù…ØªØ¬Ø± ÙˆØ®Ø¯Ù…Ø§Øª ØµÙŠØ§Ù†Ø© Ø§Ù„Ù‡ÙˆØ§ØªÙ</small>
        </div>
      </div>

      <div class="searchbar">
        <input id="searchInput" type="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬ Ø£Ùˆ Ø®Ø¯Ù…Ø©â€¦" data-i18n-placeholder="searchPlaceholder" />
        <button class="btn" id="clearSearch" title="Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«">âœ–</button>
      </div>

      <div class="actions">
        <span class="chip" id="storeStatus" data-i18n="statusOnline">Ø§Ù„Ø­Ø§Ù„Ø©: Ù…ØªØµÙ„</span>
        <button class="btn" id="langBtn" title="Language / Ø§Ù„Ù„ØºØ©" aria-label="Language Toggle"><span id="langLabel">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span> ğŸŒ</button>
        <button class="btn" id="themeBtn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹" aria-label="Theme Toggle"><span id="themeLabel" data-i18n="theme">Ø§Ù„ÙˆØ¶Ø¹</span> <span id="themeIcon">ğŸŒ™</span></button>
        <button class="btn" id="loginBtn" data-i18n="login">Ø¯Ø®ÙˆÙ„ (Ù…Ø­Ø§ÙƒØ§Ø©)</button>
        <div id="userMenu" style="display:none;align-items:center;gap:.6rem;">
          <img id="userAvatar" src="" alt="" style="width:34px;height:34px;border-radius:50%;border:1px solid rgba(148,163,184,.04)" />
          <span id="userName" class="chip"></span>
          <button class="btn" id="logoutBtn" data-i18n="logout">Ø®Ø±ÙˆØ¬</button>
        </div>
        <button class="btn primary" id="openCart" data-i18n="cartButton">Ø³Ù„Ø© (<span id="cartCount">0</span>)</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Hero -->
    <section class="hero">
      <div class="card">
        <h1><span data-i18n="welcome">Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ</span> <span style="color:#06b6d4">Fast Phone</span> âš¡ï¸</h1>
        <p data-i18n="heroText">Ø§Ø·Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙˆØ´Ø§Ù‡Ø¯ Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ù„Ø¯ÙŠÙ†Ø§. Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø·Ù„Ø¨" Ø³ØªÙÙØªØ­ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ø­Ù„ Ø¨Ø±Ø³Ø§Ù„Ø© Ø¬Ø§Ù‡Ø²Ø©. Ø§Ù„Ù…Ø§Ù„Ùƒ ÙÙ‚Ø· ÙŠÙ…ÙƒÙ†Ù‡ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ±.</p>
        <div class="stats">
          <div class="stat"><div class="pill" data-i18n="avgRepair">Ù…ØªÙˆØ³Ø· Ø²Ù…Ù† Ø§Ù„Ø¥ØµÙ„Ø§Ø­</div><div style="font-size:1.15rem;font-weight:800">2â€“24h</div></div>
          <div class="stat"><div class="pill" data-i18n="warranty">Ø¶Ù…Ø§Ù† Ø§Ù„ØµÙŠØ§Ù†Ø©</div><div style="font-size:1.15rem;font-weight:800">30 ÙŠÙˆÙ…</div></div>
          <div class="stat"><div class="pill" data-i18n="payment">Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹</div><div style="font-size:1.15rem;font-weight:800">Ù†Ù‚Ø¯ÙŠ / CIB</div></div>
        </div>
      </div>

      <div class="card" style="display:grid;align-content:center;gap:.8rem;">
        <div class="alert" style="background:#071226;padding:.6rem;border-radius:10px;border:1px solid rgba(148,163,184,.04)"><strong data-i18n="reminder">ØªØ°ÙƒÙŠØ±:</strong> <span data-i18n="reminderDetail">ÙØ¹Ù‘Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¬ÙˆØ¬Ù„ Ø¨Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ.</span></div>
        <div style="display:flex;gap:.6rem;flex-wrap:wrap;">
          <button class="btn success" id="openOwnerPanel" data-i18n="ownerPanel">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„Ùƒ</button>
          <button class="btn" id="backupBtn" data-i18n="backup">Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù…Ø­Ù„ÙŠ</button>
          <button class="btn" id="restoreBtn" data-i18n="restore">Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>
      </div>
    </section>

    <!-- Main Grid -->
    <section class="grid two-col">
      <div>
        <div class="section-title">
          <h2 data-i18n="products">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
          <div class="filters" style="display:flex;align-items:center;gap:.5rem">
            <select id="sortSelect" class="pill" title="ÙØ±Ø²" data-i18n-select="sort">
              <option value="pop" data-i18n="sortPopular">Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ù‹Ø§</option>
              <option value="new" data-i18n="sortNewest">Ø§Ù„Ø£Ø­Ø¯Ø«</option>
              <option value="price-asc" data-i18n="sortPriceAsc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¹Ù„Ù‰</option>
              <option value="price-desc" data-i18n="sortPriceDesc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ù‚Ù„</option>
            </select>
            <button class="pill" id="filterInStock" data-i18n="inStockOnly">Ù…ØªÙˆÙØ± ÙÙ‚Ø·</button>
            <button class="pill" id="resetFilters" data-i18n="resetFilters">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
          </div>
        </div>

        <div id="catalog" class="catalog"></div>

        <div class="section-title" style="margin-top:1.2rem;">
          <h2 data-i18n="servicesTitle">Ø§Ù„Ø®Ø¯Ù…Ø§Øª</h2>
          <div class="filters">
            <span class="pill" data-i18n="serviceWarranty">Ø¶Ù…Ø§Ù† 30 ÙŠÙˆÙ…</span>
            <span class="pill" data-i18n="freeCheck">ÙØ­Øµ Ù…Ø¬Ø§Ù†ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­</span>
          </div>
        </div>

        <div id="services" class="services"></div>
      </div>

      <aside>
        <div class="card cart" id="cartPanel">
          <div class="head">
            <strong data-i18n="cartTitle">Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</strong>
            <button class="icon-btn" id="clearCart" title="ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©">ğŸ—‘</button>
          </div>
          <div class="items" id="cartItems">
            <div class="empty" data-i18n="cartEmpty">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹</div>
          </div>
          <div class="foot" style="padding:.9rem">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <span data-i18n="total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
              <strong id="cartTotal">0 Ø¯.Ø¬</strong>
            </div>
            <div style="display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.6rem;">
              <input id="couponInput" class="pill" placeholder="ÙƒÙˆØ¨ÙˆÙ† Ø®ØµÙ…" data-i18n-placeholder="couponPlaceholder" />
              <button class="btn" id="applyCoupon" data-i18n="applyCoupon">ØªØ·Ø¨ÙŠÙ‚</button>
              <button class="btn primary" id="checkoutBtn" data-i18n="checkout">Ø·Ù„Ø¨</button>
            </div>
            <div class="badge" id="cartNote" data-i18n="cartNote" style="margin-top:.6rem">Ø³ØªØªÙ… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ.</div>
          </div>
        </div>
      </aside>
    </section>

    <footer class="container footer">
      <div>Â© <span id="year"></span> Fast Phone â€” <span data-i18n="footer">ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</span></div>
      <div class="chip">v1.0</div>
    </footer>
  </main>

  <!-- Owner/Admin Panel -->
  <dialog id="ownerDialog">
    <div class="modal-body">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <h3 style="font-size:1.05rem" data-i18n="ownerPanel">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„Ùƒ</h3>
        <button class="icon-btn" id="closeOwnerDialog">âœ–</button>
      </div>

      <div class="badge" id="ownerEmailBadge">â€”</div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:.8rem">
        <section class="card" style="padding:.8rem">
          <h4 data-i18n="manageProducts">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h4>
          <div class="field"><label data-i18n="pName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label><input id="pName" /></div>
          <div class="field"><label data-i18n="pPrice">Ø§Ù„Ø³Ø¹Ø± (Ø¯.Ø¬)</label><input id="pPrice" type="number" min="0" /></div>
          <div class="field"><label data-i18n="pOldPrice">Ø³Ø¹Ø± Ù‚Ø¯ÙŠÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label><input id="pOldPrice" type="number" min="0" /></div>
          <div class="field"><label data-i18n="pStock">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</label><input id="pStock" type="number" min="0" /></div>
          <div class="field"><label data-i18n="pImage">Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©</label><input id="pImage" placeholder="https://..." /></div>
          <div class="field"><label data-i18n="pCategory">Ø§Ù„ÙØ¦Ø©</label>
            <select id="pCategory">
              <option value="accessories" data-i18n="catAccessories">Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª</option>
              <option value="spare" data-i18n="catSpare">Ù‚Ø·Ø¹ ØºÙŠØ§Ø±</option>
              <option value="phones" data-i18n="catPhones">Ù‡ÙˆØ§ØªÙ</option>
            </select>
          </div>
          <div style="display:flex;gap:.5rem;margin-top:.5rem;flex-wrap:wrap;">
            <button class="btn success" id="addProduct" data-i18n="add">Ø¥Ø¶Ø§ÙØ©</button>
            <button class="btn" id="updateProduct" data-i18n="update">ØªØ¹Ø¯ÙŠÙ„</button>
            <button class="btn" id="deleteProduct" data-i18n="delete">Ø­Ø°Ù</button>
          </div>
          <div class="field" style="margin-top:.6rem"><label data-i18n="selectProduct">Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ù‹Ø§ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„</label><select id="productSelect"></select></div>
        </section>

        <section class="card" style="padding:.8rem">
          <h4 data-i18n="manageServices">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª</h4>
          <div class="field"><label data-i18n="sTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¯Ù…Ø©</label><input id="sTitle" /></div>
          <div class="field"><label data-i18n="sDesc">ÙˆØµÙ</label><textarea id="sDesc"></textarea></div>
          <div class="field"><label data-i18n="sPrice">Ø³Ø¹Ø± ØªÙ‚Ø±ÙŠØ¨ÙŠ (Ø¯.Ø¬)</label><input id="sPrice" type="number" min="0" /></div>
          <div style="display:flex;gap:.5rem;margin-top:.4rem;flex-wrap:wrap;">
            <button class="btn success" id="addService" data-i18n="add">Ø¥Ø¶Ø§ÙØ©</button>
            <button class="btn" id="updateService" data-i18n="update">ØªØ¹Ø¯ÙŠÙ„</button>
            <button class="btn" id="deleteService" data-i18n="delete">Ø­Ø°Ù</button>
          </div>
          <div class="field" style="margin-top:.6rem"><label data-i18n="selectService">Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„</label><select id="serviceSelect"></select></div>
        </section>
      </div>

      <section class="card" style="padding:.8rem;margin-top:.6rem">
        <h4 data-i18n="coupons">Ù‚Ø³Ø§Ø¦Ù… Ø§Ù„Ø®ØµÙ…</h4>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:.6rem;">
          <div class="field"><label data-i18n="cCode">Ø§Ù„ÙƒÙˆØ¯</label><input id="cCode" /></div>
          <div class="field"><label data-i18n="cPercent">Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… %</label><input id="cPercent" type="number" min="0" max="100" /></div>
          <div class="field"><label data-i18n="cActive">Ù…ÙØ¹Ù„ØŸ</label><select id="cActive"><option value="true" data-i18n="yes">Ù†Ø¹Ù…</option><option value="false" data-i18n="no">Ù„Ø§</option></select></div>
        </div>
        <div style="display:flex;gap:.5rem;margin-top:.6rem;align-items:end;">
          <button class="btn success" id="addCoupon" data-i18n="add">Ø¥Ø¶Ø§ÙØ©</button>
          <button class="btn" id="deleteCoupon" data-i18n="delete">Ø­Ø°Ù</button>
        </div>
        <div class="field" style="margin-top:.6rem"><label data-i18n="existingCoupons">Ø§Ù„Ù‚Ø³Ø§Ø¦Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ©</label><select id="couponSelect"></select></div>
      </section>

      <section class="card" style="padding:.8rem;margin-top:.6rem;display:grid;gap:.6rem;">
        <h4 data-i18n="data">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
        <div style="display:flex;gap:.5rem;flex-wrap:wrap;">
          <button class="btn" id="exportBtn" data-i18n="export">ØªØµØ¯ÙŠØ± JSON</button>
          <input type="file" id="importFile" accept="application/json" style="display:none;" />
          <button class="btn" id="importBtn" data-i18n="import">Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON</button>
        </div>
      </section>
    </div>
  </dialog>

  <!-- ========================= SCRIPT ========================= -->
  <script>
    // ========================= Config =========================
    const OWNER_EMAIL = "owner@example.com"; // ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ù‹Ø§
    const OWNER_CHAT = {
      type: "whatsapp",
      phone: "213657340489", // ØªÙ… Ø¶Ø¨Ø·Ù‡ Ø­Ø³Ø¨ Ø·Ù„Ø¨Ùƒ
      telegramUser: "fastphone_owner",
      messengerUser: "fastphone.page"
    };

    const LS_KEYS = {
      CART: "ff_cart",
      PRODUCTS: "ff_products",
      SERVICES: "ff_services",
      COUPONS: "ff_coupons",
      THEME: "ff_theme",
      LANG: "ff_lang"
    };

    const CURRENCY = "Ø¯.Ø¬";

    // ========================= I18N =========================
    const I18N = {
      ar: {
        brandTitle: "Fast Phone",
        brandSubtitle: "Ù…ØªØ¬Ø± ÙˆØ®Ø¯Ù…Ø§Øª ØµÙŠØ§Ù†Ø© Ø§Ù„Ù‡ÙˆØ§ØªÙ",
        statusOnline: "Ø§Ù„Ø­Ø§Ù„Ø©: Ù…ØªØµÙ„",
        theme: "Ø§Ù„ÙˆØ¶Ø¹",
        login: "Ø¯Ø®ÙˆÙ„ (Ù…Ø­Ø§ÙƒØ§Ø©)",
        logout: "Ø®Ø±ÙˆØ¬",
        cartButton: "Ø³Ù„Ø© ({{count}})",
        welcome: "Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ",
        heroText: "Ø§Ø·Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙˆØ´Ø§Ù‡Ø¯ Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ù„Ø¯ÙŠÙ†Ø§. Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ \"Ø·Ù„Ø¨\" Ø³ØªÙÙØªØ­ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ø­Ù„ Ø¨Ø±Ø³Ø§Ù„Ø© Ø¬Ø§Ù‡Ø²Ø©. Ø§Ù„Ù…Ø§Ù„Ùƒ ÙÙ‚Ø· ÙŠÙ…ÙƒÙ†Ù‡ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ±.",
        avgRepair: "Ù…ØªÙˆØ³Ø· Ø²Ù…Ù† Ø§Ù„Ø¥ØµÙ„Ø§Ø­",
        warranty: "Ø¶Ù…Ø§Ù† Ø§Ù„ØµÙŠØ§Ù†Ø©",
        payment: "Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹",
        reminder: "ØªØ°ÙƒÙŠØ±:",
        reminderDetail: "ÙØ¹Ù‘Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¬ÙˆØ¬Ù„ Ø¨Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ.",
        ownerFeatureTitle: "Ø®Ø§ØµÙŠØ© Ø§Ù„Ù…Ø§Ù„Ùƒ:",
        ownerFeature: "Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø§Ù„Ùƒ ØªØ³ØªØ·ÙŠØ¹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ….",
        ordersTitle: "Ø§Ù„Ø·Ù„Ø¨Ø§Øª:",
        ordersDetail: "Ø²Ø± \"Ø·Ù„Ø¨\" ÙŠÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨/ØªÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¨Ø±Ø³Ø§Ù„Ø© Ù…ÙØµÙ„Ø© ØªØ´Ù…Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù…Ù† Ø§Ù„Ø³Ù„Ø©.",
        ownerPanel: "Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„Ùƒ",
        backup: "Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù…Ø­Ù„ÙŠ",
        restore: "Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª",
        products: "Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
        sortPopular: "Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ù‹Ø§",
        sortNewest: "Ø§Ù„Ø£Ø­Ø¯Ø«",
        sortPriceAsc: "Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¹Ù„Ù‰",
        sortPriceDesc: "Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ù‚Ù„",
        inStockOnly: "Ù…ØªÙˆÙØ± ÙÙ‚Ø·",
        resetFilters: "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†",
        servicesTitle: "Ø§Ù„Ø®Ø¯Ù…Ø§Øª",
        serviceWarranty: "Ø¶Ù…Ø§Ù† 30 ÙŠÙˆÙ…",
        freeCheck: "ÙØ­Øµ Ù…Ø¬Ø§Ù†ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­",
        cartTitle: "Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª",
        cartEmpty: "Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹",
        total: "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ",
        couponPlaceholder: "ÙƒÙˆØ¨ÙˆÙ† Ø®ØµÙ…",
        applyCoupon: "ØªØ·Ø¨ÙŠÙ‚",
        checkout: "Ø·Ù„Ø¨",
        cartNote: "Ø³ØªØªÙ… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ.",
        footer: "ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.",
        manageProducts: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
        pName: "Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬",
        pPrice: "Ø§Ù„Ø³Ø¹Ø± (Ø¯.Ø¬)",
        pOldPrice: "Ø³Ø¹Ø± Ù‚Ø¯ÙŠÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",
        pStock: "Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
        pImage: "Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©",
        pCategory: "Ø§Ù„ÙØ¦Ø©",
        catAccessories: "Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª",
        catSpare: "Ù‚Ø·Ø¹ ØºÙŠØ§Ø±",
        catPhones: "Ù‡ÙˆØ§ØªÙ",
        add: "Ø¥Ø¶Ø§ÙØ©",
        update: "ØªØ¹Ø¯ÙŠÙ„",
        delete: "Ø­Ø°Ù",
        selectProduct: "Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ù‹Ø§ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„",
        manageServices: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª",
        sTitle: "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¯Ù…Ø©",
        sDesc: "ÙˆØµÙ",
        sPrice: "Ø³Ø¹Ø± ØªÙ‚Ø±ÙŠØ¨ÙŠ (Ø¯.Ø¬)",
        selectService: "Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„",
        coupons: "Ù‚Ø³Ø§Ø¦Ù… Ø§Ù„Ø®ØµÙ…",
        cCode: "Ø§Ù„ÙƒÙˆØ¯",
        cPercent: "Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… %",
        cActive: "Ù…ÙØ¹Ù„ØŸ",
        yes: "Ù†Ø¹Ù…",
        no: "Ù„Ø§",
        existingCoupons: "Ø§Ù„Ù‚Ø³Ø§Ø¦Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ©",
        data: "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
        export: "ØªØµØ¯ÙŠØ± JSON",
        import: "Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON",
        searchPlaceholder: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬ Ø£Ùˆ Ø®Ø¯Ù…Ø©â€¦"
      },
      fr: {
        brandTitle: "Fast Phone",
        brandSubtitle: "Boutique et services de rÃ©paration",
        statusOnline: "Statut : en ligne",
        theme: "ThÃ¨me",
        login: "Connexion (simulation)",
        logout: "DÃ©connexion",
        cartButton: "Panier ({{count}})",
        welcome: "Bienvenue chez",
        heroText: "Commandez les produits disponibles et consultez nos services. En appuyant sur \"Commander\", une discussion avec le propriÃ©taire s'ouvrira avec un message prÃªt. Seul le propriÃ©taire peut gÃ©rer les Ã©lÃ©ments.",
        avgRepair: "DÃ©lai moyen de rÃ©paration",
        warranty: "Garantie rÃ©paration",
        payment: "Moyens de paiement",
        reminder: "Rappel :",
        reminderDetail: "Activez la connexion Google en ajoutant votre configuration Firebase.",
        ownerFeatureTitle: "Pour le propriÃ©taire :",
        ownerFeature: "ConnectÃ© avec le compte du propriÃ©taire, vous pouvez gÃ©rer produits et services.",
        ordersTitle: "Commandes :",
        ordersDetail: "Le bouton \"Commander\" ouvre WhatsApp/Telegram du propriÃ©taire avec le panier.",
        ownerPanel: "Panneau du propriÃ©taire",
        backup: "Sauvegarde locale",
        restore: "Restaurer",
        products: "Produits",
        sortPopular: "Les plus populaires",
        sortNewest: "Les plus rÃ©cents",
        sortPriceAsc: "Prix : croissant",
        sortPriceDesc: "Prix : dÃ©croissant",
        inStockOnly: "En stock seulement",
        resetFilters: "RÃ©initialiser",
        servicesTitle: "Services",
        serviceWarranty: "Garantie 30 jours",
        freeCheck: "Diagnostic gratuit avec rÃ©paration",
        cartTitle: "Panier",
        cartEmpty: "Le panier est vide",
        total: "Total",
        couponPlaceholder: "Code promo",
        applyCoupon: "Appliquer",
        checkout: "Commander",
        cartNote: "La commande se fera via une discussion avec le propriÃ©taire.",
        footer: "Tous droits rÃ©servÃ©s.",
        manageProducts: "GÃ©rer les produits",
        pName: "Nom du produit",
        pPrice: "Prix (DZD)",
        pOldPrice: "Ancien prix (optionnel)",
        pStock: "Stock",
        pImage: "URL de l'image",
        pCategory: "CatÃ©gorie",
        catAccessories: "Accessoires",
        catSpare: "PiÃ¨ces dÃ©tachÃ©es",
        catPhones: "TÃ©lÃ©phones",
        add: "Ajouter",
        update: "Mettre Ã  jour",
        delete: "Supprimer",
        selectProduct: "Choisir un produit",
        manageServices: "GÃ©rer les services",
        sTitle: "Titre du service",
        sDesc: "Description",
        sPrice: "Prix estimatif (DZD)",
        selectService: "Choisir un service",
        coupons: "Codes promo",
        cCode: "Code",
        cPercent: "RÃ©duction %",
        cActive: "Actif ?",
        yes: "Oui",
        no: "Non",
        existingCoupons: "Codes existants",
        data: "DonnÃ©es",
        export: "Exporter JSON",
        import: "Importer JSON",
        searchPlaceholder: "Rechercher un produit ou un serviceâ€¦"
      }
    };

    // ========================= Helpers =========================
    const $ = (s, ctx=document) => ctx.querySelector(s);
    const $$ = (s, ctx=document) => Array.from(ctx.querySelectorAll(s));
    function uid(pref='id'){ return pref + '_' + Math.random().toString(36).slice(2,9); }
    function saveLS(k,v){ localStorage.setItem(k, JSON.stringify(v)); }
    function loadLS(k, fallback){ try{ const v=JSON.parse(localStorage.getItem(k)); return v ?? fallback; }catch{ return fallback; } }
    function toast(msg){ const t=document.createElement('div'); t.textContent=msg; Object.assign(t.style,{position:'fixed',bottom:'16px',right:'16px',padding:'10px 14px',background:'#0b1324',border:'1px solid rgba(148,163,184,.06)',borderRadius:'12px',boxShadow:'0 8px 22px rgba(0,0,0,.6)',zIndex:9999,color:'#e2e8f0'}); document.body.appendChild(t); setTimeout(()=>t.remove(),2200) }

    function formatPrice(num){ return `${Number(num||0).toLocaleString(currentLang)} ${CURRENCY}`; }

    // ========================= State (with localStorage) =========================
    let currentLang = localStorage.getItem(LS_KEYS.LANG) || 'ar';
    let products = loadLS(LS_KEYS.PRODUCTS, [
      { id: uid('p'), name: 'Ø´Ø§Ø­Ù† Ø³Ø±ÙŠØ¹ 20W', price: 2200, oldPrice: 2600, stock: 8, image: 'https://images.unsplash.com/photo-1609592424022-59df09ee59d2?auto=format&fit=crop&w=800&q=60', category: 'accessories', pop: 93, createdAt: Date.now()-86400000*4 },
      { id: uid('p'), name: 'Ø³Ù…Ø§Ø¹Ø§Øª Ø¨Ù„ÙˆØªÙˆØ«', price: 3500, oldPrice: 0, stock: 12, image: 'https://images.unsplash.com/photo-1518444314310-66b7a31f10bf?auto=format&fit=crop&w=800&q=60', category: 'accessories', pop: 120, createdAt: Date.now()-86400000*2 },
      { id: uid('p'), name: 'Ø´Ø§Ø´Ø© Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù‡Ø§ØªÙ XYZ', price: 9500, oldPrice: 11000, stock: 4, image: 'https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=800&q=60', category: 'spare', pop: 75, createdAt: Date.now()-86400000*7 },
      { id: uid('p'), name: 'ØºØ·Ø§Ø¡ Ø­Ù…Ø§ÙŠØ© Ø³ÙŠÙ„ÙŠÙƒÙˆÙ†', price: 900, oldPrice: 1200, stock: 25, image: 'https://images.unsplash.com/photo-1598965402089-897ce52e835b?auto=format&fit=crop&w=800&q=60', category: 'accessories', pop: 60, createdAt: Date.now()-86400000*1 },
      { id: uid('p'), name: 'Ù‡Ø§ØªÙ Ù…Ø³ØªØ¹Ù…Ù„ Ø¨Ø­Ø§Ù„Ø© Ù…Ù…ØªØ§Ø²Ø©', price: 42000, oldPrice: 0, stock: 2, image: 'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=800&q=60', category: 'phones', pop: 35, createdAt: Date.now()-86400000*10 }
    ]);
    let services = loadLS(LS_KEYS.SERVICES, [
      { id: uid('s'), title: 'ØªØ¨Ø¯ÙŠÙ„ Ø´Ø§Ø´Ø©', desc: 'Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø´Ø§Ø´Ø© Ù…ÙƒØ³ÙˆØ±Ø©/Ù…Ø¹Ø·Ù„Ø© Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ù…Ø¹ Ø¶Ù…Ø§Ù† 30 ÙŠÙˆÙ….', price: 8000 },
      { id: uid('s'), title: 'ØªØºÙŠÙŠØ± Ø¨Ø·Ø§Ø±ÙŠØ©', desc: 'Ø¨Ø·Ø§Ø±ÙŠØ§Øª Ø£ØµÙ„ÙŠØ©/Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ø¹ ÙØ­Øµ Ù…Ø¬Ø§Ù†ÙŠ.', price: 5000 },
      { id: uid('s'), title: 'ØªÙ†Ø¸ÙŠÙ Ù…Ø¯Ø®Ù„ Ø§Ù„Ø´Ø­Ù†', desc: 'ØªÙ†Ø¸ÙŠÙ Ø§Ø­ØªØ±Ø§ÙÙŠ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ.', price: 1200 }
    ]);
    let coupons = loadLS(LS_KEYS.COUPONS, [
      { code: 'FAST10', percent: 10, active: true },
      { code: 'WELCOME5', percent: 5, active: true }
    ]);
    let cart = loadLS(LS_KEYS.CART, []);

    // ========================= Rendering =========================
    function productCard(p){
      const outOfStock = p.stock <= 0;
      return `
      <article class="card product" data-id="${p.id}" data-name="${p.name.toLowerCase()}" data-category="${p.category}">
        <div class="thumb">
          <img src="${p.image}" alt="${p.name}" loading="lazy" style="width:100%;height:100%;object-fit:cover" />
        </div>
        <div class="body">
          <div class="name" style="font-weight:800">${p.name}</div>
          <div class="meta" style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <span class="price">${formatPrice(p.price)}</span>
              ${p.oldPrice? `<span class="old">${formatPrice(p.oldPrice)}</span>` : ''}
            </div>
            <span class="badge" style="color:#94a3b8">${currentLang==='ar'?'Ø§Ù„Ù…Ø®Ø²ÙˆÙ†':'Stock'}: ${p.stock}</span>
          </div>
          <div class="actions" style="margin-top:.5rem;display:flex;gap:.5rem">
            <button class="btn" data-action="add" ${outOfStock?'disabled':''}>${currentLang==='ar'?'Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©':'Ajouter'}</button>
            <button class="btn primary" data-action="buy" ${outOfStock?'disabled':''}>${currentLang==='ar'?'Ø·Ù„Ø¨':'Commander'}</button>
          </div>
        </div>
      </article>`;
    }

    function renderCatalog(){
      const catalog = $('#catalog');
      if(!catalog) return;
      const query = ($('#searchInput')?.value || '').toLowerCase().trim();
      const inStock = $('#filterInStock')?.classList.contains('active');
      const sort = $('#sortSelect')?.value || 'pop';
      let list = [...products];
      if(query) list = list.filter(p => p.name.toLowerCase().includes(query));
      if(inStock) list = list.filter(p => p.stock > 0);
      if(sort === 'pop') list.sort((a,b)=> b.pop - a.pop);
      if(sort === 'new') list.sort((a,b)=> b.createdAt - a.createdAt);
      if(sort === 'price-asc') list.sort((a,b)=> a.price - b.price);
      if(sort === 'price-desc') list.sort((a,b)=> b.price - a.price);

      catalog.innerHTML = list.map(productCard).join('') || `<div class="empty">${currentLang==='ar'?'Ù„Ø§ Ù†ØªØ§Ø¦Ø¬':'Aucun rÃ©sultat'}</div>`;

      // bind product buttons
      $$('#catalog .product .actions .btn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const card = btn.closest('.product');
          const id = card.getAttribute('data-id');
          const item = products.find(p=>p.id===id);
          if(!item) return;
          const action = btn.getAttribute('data-action');
          if(action === 'add') addToCart(item.id,1);
          if(action === 'buy') { addToCart(item.id,1); openCheckout(); }
        });
      });
    }

    function serviceCard(s){
      return `
      <article class="card service">
        <div class="icon" style="font-size:22px">ğŸ”§</div>
        <div style="min-width:0">
          <div class="title" style="font-weight:800">${s.title}</div>
          <div class="desc" style="color:#94a3b8">${s.desc}</div>
          <div class="price" style="margin-top:.3rem;font-weight:800;color:#86efac">${formatPrice(s.price)}</div>
        </div>
      </article>`;
    }

    function renderServices(){
      const wrap = $('#services');
      if(!wrap) return;
      wrap.innerHTML = services.map(serviceCard).join('');
    }

    // ========================= Cart =========================
    function addToCart(productId, qty=1){
      const p = products.find(x=>x.id===productId);
      if(!p || p.stock <= 0) return toast(currentLang==='ar'?'ØºÙŠØ± Ù…ØªÙˆÙØ±':'Indisponible');
      const row = cart.find(x=>x.id===productId);
      if(row) row.qty += qty; else cart.push({ id: productId, qty });
      saveLS(LS_KEYS.CART, cart);
      updateCartCount(); renderCart(); toast(currentLang==='ar'?'Ø£Ø¶ÙŠÙ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©':'AjoutÃ© au panier');
    }

    function updateCartCount(){
      const count = cart.reduce((n,x)=>n+x.qty,0);
      $('#cartCount').textContent = count;
      const dict = I18N[currentLang] ?? I18N.ar;
      const btn = $('#openCart');
      if(btn) btn.innerHTML = (dict.cartButton || 'Ø³Ù„Ø© ({{count}})').replace('{{count}}', `<span id="cartCount">${count}</span>`);
    }

    let appliedCoupon = null;
    function calcCartTotal(){
      let total = 0;
      cart.forEach(row=>{
        const p = products.find(x=>x.id===row.id);
        if(p) total += p.price * row.qty;
      });
      let discount = 0;
      if(appliedCoupon && appliedCoupon.active) discount = Math.round(total * (appliedCoupon.percent/100));
      return { total, discount, grand: Math.max(total-discount,0) };
    }

    function renderCart(){
      const box = $('#cartItems');
      if(!box) return;
      if(!cart.length){
        box.innerHTML = `<div class="empty">${currentLang==='ar'?'Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹':'Le panier est vide'}</div>`;
      } else {
        box.innerHTML = cart.map(row=>{
          const p = products.find(x=>x.id===row.id);
          if(!p) return '';
          return `
          <div class="row" data-id="${row.id}">
            <div>
              <div class="name" style="font-weight:800">${p.name}</div>
              <div class="pill" style="margin-top:.2rem">${formatPrice(p.price)} Ã— ${row.qty}</div>
            </div>
            <div class="qty" style="display:flex;align-items:center;gap:.4rem">
              <button class="icon-btn" data-act="dec">â–</button>
              <strong>${row.qty}</strong>
              <button class="icon-btn" data-act="inc">â•</button>
              <button class="icon-btn" data-act="del" title="${currentLang==='ar'?'Ø­Ø°Ù':'Supprimer'}">ğŸ—‘</button>
            </div>
          </div>`;
        }).join('');
      }

      const { total, discount, grand } = calcCartTotal();
      $('#cartTotal').textContent = formatPrice(grand);

      $$('#cartItems .row .icon-btn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const rowEl = btn.closest('.row');
          const id = rowEl.getAttribute('data-id');
          const act = btn.getAttribute('data-act');
          const idx = cart.findIndex(x=>x.id===id);
          if(idx === -1) return;
          if(act === 'inc') cart[idx].qty++;
          if(act === 'dec') cart[idx].qty = Math.max(1, cart[idx].qty - 1);
          if(act === 'del') cart.splice(idx,1);
          saveLS(LS_KEYS.CART, cart);
          updateCartCount(); renderCart();
        });
      });
    }

    // ========================= Coupon & Cart Actions =========================
    $('#applyCoupon').addEventListener('click', ()=>{
      const code = ($('#couponInput').value || '').trim().toUpperCase();
      if(!code) return toast(currentLang==='ar'?'Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯':'Entrez le code');
      const c = coupons.find(x=>x.code.toUpperCase()===code && x.active);
      if(!c){ appliedCoupon = null; toast(currentLang==='ar'?'ÙƒÙˆØ¨ÙˆÙ† ØºÙŠØ± ØµØ§Ù„Ø­':'Code invalide'); renderCart(); return; }
      appliedCoupon = c; toast(currentLang==='ar'?'ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®ØµÙ…':'Remise appliquÃ©e'); renderCart();
    });

    $('#clearCart').addEventListener('click', ()=>{
      cart = []; saveLS(LS_KEYS.CART, cart); appliedCoupon = null; $('#couponInput').value=''; updateCartCount(); renderCart();
    });

    $('#openCart').addEventListener('click', ()=>{ toast(currentLang==='ar'?'ØªÙ… ÙØªØ­ Ø§Ù„Ø³Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†':'Panier ouvert Ã  droite'); });

    function openCheckout(){
      if(!cart.length) return toast(currentLang==='ar'?'Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©':'Panier vide');
      const { total, discount, grand } = calcCartTotal();
      const lines = cart.map(row=>{
        const p = products.find(x=>x.id===row.id);
        return p ? `â€¢ ${p.name} Ã— ${row.qty} = ${formatPrice(p.price * row.qty)}` : '';
      }).filter(Boolean);
      const header = currentLang==='ar' ? 'Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Fast Phone' : 'Nouvelle commande depuis Fast Phone';
      const totLine = `${currentLang==='ar'?'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹':'Total'}: ${formatPrice(total)}`;
      const discLine = discount ? `\n${currentLang==='ar'?'Ø§Ù„Ø®ØµÙ…':'Remise'}: -${formatPrice(discount)}` : '';
      const grandLine = `\n${currentLang==='ar'?'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…':'Total Ã  payer'}: ${formatPrice(grand)}`;
      const note = currentLang==='ar'?'Ù…Ù† ÙØ¶Ù„Ùƒ Ø£ÙƒØ¯ÙˆØ§ Ø§Ù„ØªÙˆÙØ± ÙˆØ§Ù„Ù…ÙˆØ¹Ø¯.':'Merci de confirmer la disponibilitÃ© et le dÃ©lai.';
      const msg = `${header}\n\n${lines.join('\n')}\n\n${totLine}${discLine}${grandLine}\n\n${note}`;

      let url = '';
      if(OWNER_CHAT.type === 'whatsapp'){ const phone = (OWNER_CHAT.phone||'').replace(/[^\d]/g,''); url = `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`; }
      else if(OWNER_CHAT.type === 'telegram'){ url = `https://t.me/${OWNER_CHAT.telegramUser}?text=${encodeURIComponent(msg)}`; }
      else if(OWNER_CHAT.type === 'messenger'){ url = `https://m.me/${OWNER_CHAT.messengerUser}?text=${encodeURIComponent(msg)}`; }
      else { const phone = (OWNER_CHAT.phone||'').replace(/[^\d]/g,''); url = `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`; }

      window.open(url, '_blank');
    }
    $('#checkoutBtn').addEventListener('click', openCheckout);

    // ========================= Filters & Search =========================
    $('#searchInput').addEventListener('input', ()=>renderCatalog());
    $('#clearSearch').addEventListener('click', ()=>{ $('#searchInput').value=''; renderCatalog(); });
    $('#sortSelect').addEventListener('change', renderCatalog);
    $('#filterInStock').addEventListener('click', (e)=>{ e.currentTarget.classList.toggle('active'); renderCatalog(); });
    $('#resetFilters').addEventListener('click', ()=>{ $('#sortSelect').value='pop'; $('#filterInStock').classList.remove('active'); $('#searchInput').value=''; renderCatalog(); });

    // ========================= Theme & Language =========================
    function setTheme(mode){
      if(mode === 'light') document.body.classList.add('light'); else document.body.classList.remove('light');
      localStorage.setItem(LS_KEYS.THEME, mode); $('#themeIcon').textContent = mode === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';
    }
    function toggleTheme(){ const cur = localStorage.getItem(LS_KEYS.THEME) || 'dark'; setTheme(cur === 'dark' ? 'light' : 'dark'); }
    $('#themeBtn').addEventListener('click', toggleTheme);
    setTheme(localStorage.getItem(LS_KEYS.THEME) || 'dark');

    function applyI18n(){
      const dict = I18N[currentLang] || I18N.ar;
      $$('[data-i18n]').forEach(el => { const key = el.getAttribute('data-i18n'); if(dict[key]) el.textContent = dict[key]; });
      $$('[data-i18n-placeholder]').forEach(el => { const key = el.getAttribute('data-i18n-placeholder'); if(dict[key]) el.placeholder = dict[key]; });
      $$('option[data-i18n]').forEach(el => { const key = el.getAttribute('data-i18n'); if(dict[key]) el.textContent = dict[key]; });
      document.documentElement.lang = currentLang; document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
      $('#langLabel').textContent = currentLang === 'ar' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'FranÃ§ais';
      updateCartCount(); renderCatalog(); renderServices();
    }
    function setLang(lang){ currentLang = lang; localStorage.setItem(LS_KEYS.LANG, lang); applyI18n(); }

    $('#langBtn').addEventListener('click', ()=> setLang(currentLang === 'ar' ? 'fr' : 'ar'));

    // ========================= Footer Year =========================
    $('#year').textContent = new Date().getFullYear();

    // ========================= Auth (Simulation) =========================
    let currentUser = null;
    function refreshUserUI(){
      if(currentUser){
        $('#loginBtn').style.display = 'none';
        $('#userMenu').style.display = 'inline-flex';
        $('#userName').textContent = currentUser.email;
        $('#userAvatar').src = currentUser.photoURL || 'https://i.pravatar.cc/64?img=12';
        $('#ownerEmailBadge').textContent = `${currentLang==='ar'?'Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø§Ù„Ùƒ:':'PropriÃ©taire :'} ${OWNER_EMAIL}`;
      } else {
        $('#loginBtn').style.display = 'inline-flex';
        $('#userMenu').style.display = 'none';
        $('#ownerEmailBadge').textContent = 'â€”';
      }
    }
    $('#loginBtn').addEventListener('click', ()=>{
      const email = prompt(currentLang==='ar'?'Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ù…Ø­Ø§ÙƒØ§Ø©)':'Entrez votre email (simulation)');
      if(!email) return;
      currentUser = { email, photoURL: '' };
      refreshUserUI(); toast(currentLang==='ar'?'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ù…Ø­Ø§ÙƒØ§Ø©)':'ConnectÃ© (simulation)');
    });
    $('#logoutBtn').addEventListener('click', ()=>{ currentUser = null; refreshUserUI(); toast(currentLang==='ar'?'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬':'DÃ©connectÃ©'); });
    function isOwner(){ return currentUser && currentUser.email && currentUser.email.toLowerCase() === OWNER_EMAIL.toLowerCase(); }

    // ========================= Owner Panel (CRUD) =========================
    const ownerDialog = $('#ownerDialog');
    $('#openOwnerPanel').addEventListener('click', ()=>{
      if(!isOwner()) return toast(currentLang==='ar'?'Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù„Ù„Ù…Ø§Ù„Ùƒ ÙÙ‚Ø·':'RÃ©servÃ© au propriÃ©taire');
      syncSelects(); ownerDialog.showModal();
    });
    $('#closeOwnerDialog').addEventListener('click', ()=> ownerDialog.close());

    function syncSelects(){
      const pSel = $('#productSelect');
      pSel.innerHTML = products.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
      const sSel = $('#serviceSelect');
      sSel.innerHTML = services.map(s => `<option value="${s.id}">${s.title}</option>`).join('');
      const cSel = $('#couponSelect');
      cSel.innerHTML = coupons.map(c => `<option value="${c.code}">${c.code} â€” ${c.percent}% ${c.active ? 'âœ“' : 'âœ—'}</option>`).join('');
    }

    $('#addProduct').addEventListener('click', ()=>{
      if(!isOwner()) return;
      const item = {
        id: uid('p'),
        name: $('#pName').value.trim(),
        price: Number($('#pPrice').value || 0),
        oldPrice: Number($('#pOldPrice').value || 0),
        stock: Number($('#pStock').value || 0),
        image: $('#pImage').value.trim() || 'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=800&q=60',
        category: $('#pCategory').value,
        pop: 0,
        createdAt: Date.now()
      };
      if(!item.name) return toast(currentLang==='ar'?'Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬':'Nom requis');
      products.push(item); saveLS(LS_KEYS.PRODUCTS, products); renderCatalog(); syncSelects(); toast(currentLang==='ar'?'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©':'AjoutÃ©');
    });

    $('#updateProduct').addEventListener('click', ()=>{
      if(!isOwner()) return;
      const id = $('#productSelect').value; const p = products.find(x=>x.id===id); if(!p) return;
      p.name = $('#pName').value.trim() || p.name;
      p.price = Number($('#pPrice').value || p.price);
      p.oldPrice = Number($('#pOldPrice').value || p.oldPrice);
      p.stock = Number($('#pStock').value || p.stock);
      p.image = $('#pImage').value.trim() || p.image;
      p.category = $('#pCategory').value || p.category;
      saveLS(LS_KEYS.PRODUCTS, products); renderCatalog(); syncSelects(); toast(currentLang==='ar'?'ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„':'Mis Ã  jour');
    });

    $('#deleteProduct').addEventListener('click', ()=>{
      if(!isOwner()) return;
      const id = $('#productSelect').value; const idx = products.findIndex(x=>x.id===id); if(idx===-1) return;
      products.splice(idx,1); saveLS(LS_KEYS.PRODUCTS, products); renderCatalog(); syncSelects(); toast(currentLang==='ar'?'ØªÙ… Ø§Ù„Ø­Ø°Ù':'SupprimÃ©');
    });

    // Services CRUD
    $('#addService').addEventListener('click', ()=>{
      if(!isOwner()) return;
      const s = { id: uid('s'), title: $('#sTitle').value.trim(), desc: $('#sDesc').value.trim(), price: Number($('#sPrice').value || 0) };
      if(!s.title) return toast(currentLang==='ar'?'Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¯Ù…Ø©':'Titre requis');
      services.push(s); saveLS(LS_KEYS.SERVICES, services); renderServices(); syncSelects(); toast(currentLang==='ar'?'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©':'AjoutÃ©');
    });
    $('#updateService').addEventListener('click', ()=>{
      if(!isOwner()) return;
      const id = $('#serviceSelect').value; const s = services.find(x=>x.id===id); if(!s) return;
      s.title = $('#sTitle').value.trim() || s.title; s.desc = $('#sDesc').value.trim() || s.desc; s.price = Number($('#sPrice').value || s.price);
      saveLS(LS_KEYS.SERVICES, services); renderServices(); syncSelects(); toast(currentLang==='ar'?'ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„':'Mis Ã  jour');
    });
    $('#deleteService').addEventListener('click', ()=>{
      if(!isOwner()) return;
      const id = $('#serviceSelect').value; const idx = services.findIndex(x=>x.id===id); if(idx===-1) return;
      services.splice(idx,1); saveLS(LS_KEYS.SERVICES, services); renderServices(); syncSelects(); toast(currentLang==='ar'?'ØªÙ… Ø§Ù„Ø­Ø°Ù':'SupprimÃ©');
    });

    // Coupons CRUD
    $('#addCoupon').addEventListener('click', ()=>{
      if(!isOwner()) return;
      const c = { code: ($('#cCode').value || '').trim(), percent: Number($('#cPercent').value || 0), active: $('#cActive').value === 'true' };
      if(!c.code) return toast(currentLang==='ar'?'Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯':'Code requis');
      const exists = coupons.find(x=>x.code.toUpperCase()===c.code.toUpperCase());
      if(exists){ exists.percent = c.percent; exists.active = c.active; } else coupons.push(c);
      saveLS(LS_KEYS.COUPONS, coupons); syncSelects(); toast(currentLang==='ar'?'ØªÙ… Ø§Ù„Ø­ÙØ¸':'EnregistrÃ©');
    });

    $('#deleteCoupon').addEventListener('click', ()=>{
      if(!isOwner()) return;
      const val = $('#couponSelect').value; const idx = coupons.findIndex(x=>x.code===val); if(idx===-1) return;
      coupons.splice(idx,1); saveLS(LS_KEYS.COUPONS, coupons); syncSelects(); toast(currentLang==='ar'?'ØªÙ… Ø§Ù„Ø­Ø°Ù':'SupprimÃ©');
    });

    // Export/Import (backup/restore)
    $('#backupBtn').addEventListener('click', ()=>{
      const data = { products, services, coupons };
      const blob = new Blob([JSON.stringify(data, null, 2)], { type:'application/json' });
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
      a.download = `fastphone-backup-${new Date().toISOString().slice(0,10)}.json`; a.click();
    });

    $('#restoreBtn').addEventListener('click', ()=> $('#importFile').click());
    $('#importBtn').addEventListener('click', ()=> $('#importFile').click());

    $('#importFile').addEventListener('change', async (e)=>{
      const file = e.target.files[0]; if(!file) return;
      const text = await file.text();
      try{
        const data = JSON.parse(text);
        if(Array.isArray(data.products)){ products = data.products; saveLS(LS_KEYS.PRODUCTS, products); }
        if(Array.isArray(data.services)){ services = data.services; saveLS(LS_KEYS.SERVICES, services); }
        if(Array.isArray(data.coupons)){ coupons = data.coupons; saveLS(LS_KEYS.COUPONS, coupons); }
        renderCatalog(); renderServices(); syncSelects(); toast(currentLang==='ar'?'ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯':'ImportÃ©');
      }catch{
        toast(currentLang==='ar'?'Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­':'Fichier invalide');
      }finally{ e.target.value=''; }
    });

    // ========================= Init =========================
    applyI18n(); renderCatalog(); renderServices(); renderCart(); refreshUserUI();
  </script>
</body>
</html>
